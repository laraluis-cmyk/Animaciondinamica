<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Monito con WASD + Space cambia color</title>
    <style>
      body {
        margin: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 20px; /* separación entre elementos */
        height: 100vh;
        background: url("verde.png") no-repeat center center fixed; 
        background-size: cover;
        font-family: Arial, sans-serif;
      }

      canvas {
        border: 2px solid black;
      }

      #canvas {
        width: 800px;
        height: 600px;
      }

      .instructions {
        width: 200px;
        height: 600px;
        background: rgba(255,255,255,0.8);
        border: 2px solid black;
        padding: 15px;
        font-size: 16px;
        line-height: 1.5em;
      }

      .instructions h2 {
        text-align: center;
        font-size: 20px;
        margin-bottom: 10px;
      }
    </style>
  </head>
  <body>
    <!-- instrucciones izquierda -->
    <div class="instructions">
      <h2>Controles</h2>
      <p>W = Arriba</p>
      <p>A = Izquierda</p>
      <p>S = Abajo</p>
      <p>D = Derecha</p>
      <p>SPACE = Cambiar color fondo</p>
    </div>

    <!-- canvas principal -->
    <canvas id="canvas" width="800" height="600"></canvas>

    <!-- instrucciones derecha -->
    <div class="instructions">
      <h2>¿Qué hacer aquí?</h2>
      <p>Usa las teclas <b>W, A, S, D</b> para mover al monito dentro del área.</p>
      <p>Presiona <b>SPACE</b> para cambiar el color de fondo del canvas:</p>
      <ul>
        <li>Blanco → Rojo</li>
        <li>Rojo → Azul</li>
        <li>Azul → Blanco</li>
      </ul>
      <p>El monito puede moverse sin importar el color de fondo.</p>
    </div>
    
    <script>
    const Keycode = {
      W: 87,
      A: 65,
      S: 83,
      D: 68,
      SPACE: 32
    };

    let canvas, context;
    let currentKey = null;
    let images = {};
    let keysPressed = {};

    let player = { x: 350, y: 250, speed: 5 };

    // Colores posibles del fondo
    let colors = ["white", "red", "blue"];
    let currentColorIndex = 0;

    function loadImages() {
      images["W"] = new Image();
      images["W"].src = "arriba.png";

      images["A"] = new Image();
      images["A"].src = "izquierda.png";

      images["S"] = new Image();
      images["S"].src = "abajo.png";

      images["D"] = new Image();
      images["D"].src = "derecha.png";
    }

    window.onload = function () {
      canvas = document.getElementById("canvas");
      context = canvas.getContext("2d");
      loadImages();
      gameLoop();
    };

    function draw() {
      // Fondo dinámico
      context.fillStyle = colors[currentColorIndex];
      context.fillRect(0, 0, canvas.width, canvas.height);

      if (currentKey) {
        context.fillStyle = "purple";
        context.font = "40px Arial";
        context.fillText(currentKey, player.x, player.y - 10);

        let img = images[currentKey];
        if (img && img.complete) {
          context.drawImage(img, player.x, player.y, 100, 100);
        }
      }
    }

    function update() {
      if (keysPressed[Keycode.W]) {
        player.y -= player.speed;
        currentKey = "W";
      }
      if (keysPressed[Keycode.S]) {
        player.y += player.speed;
        currentKey = "S";
      }
      if (keysPressed[Keycode.A]) {
        player.x -= player.speed;
        currentKey = "A";
      }
      if (keysPressed[Keycode.D]) {
        player.x += player.speed;
        currentKey = "D";
      }

      // Mantener dentro del canvas
      if (player.x < 0) player.x = 0;
      if (player.y < 0) player.y = 0;
      if (player.x + 100 > canvas.width) player.x = canvas.width - 100;
      if (player.y + 100 > canvas.height) player.y = canvas.height - 100;
    }

    function gameLoop() {
      update();
      draw();
      requestAnimationFrame(gameLoop);
    }

    function onKeyDown(event) {
      if (event.keyCode === Keycode.SPACE && !keysPressed[Keycode.SPACE]) {
        // Cambiar color cuando se presiona Space
        currentColorIndex = (currentColorIndex + 1) % colors.length;
      }
      keysPressed[event.keyCode] = true;
    }

    function onKeyUp(event) {
      keysPressed[event.keyCode] = false;
    }

    window.addEventListener('keydown', onKeyDown, false);
    window.addEventListener('keyup', onKeyUp, false);
    </script>
  </body>
</html>
